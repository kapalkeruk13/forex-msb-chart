<script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>

<script>

const chart = LightweightCharts.createChart(document.getElementById('chart'), {
    layout: {
        background: { color: '#0e0e0e' },
        textColor: '#DDD',
    },
    grid: {
        vertLines: { color: '#1f1f1f' },
        horzLines: { color: '#1f1f1f' },
    },
});

const candleSeries = chart.addCandlestickSeries();

let data = [];

// Dummy test data (nanti kita sambungkan realtime)
for (let i = 0; i < 200; i++) {
    data.push({
        time: 1700000000 + i * 60,
        open: 100 + Math.random() * 10,
        high: 105 + Math.random() * 10,
        low: 95 + Math.random() * 10,
        close: 100 + Math.random() * 10,
    });
}

candleSeries.setData(data);

// === MSB LOGIC ===
function detectMSB(data) {
    for (let i = 2; i < data.length - 2; i++) {

        // Swing High
        if (
            data[i].high > data[i-1].high &&
            data[i].high > data[i+1].high
        ) {
            if (data[i+1].close > data[i].high) {
                console.log("BOS UP at", data[i+1].time);
            }
        }

        // Swing Low
        if (
            data[i].low < data[i-1].low &&
            data[i].low < data[i+1].low
        ) {
            if (data[i+1].close < data[i].low) {
                console.log("BOS DOWN at", data[i+1].time);
            }
        }
    }
}

detectMSB(data);

</script>
