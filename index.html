<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Forex MSB Pro Chart</title>

<script src="https://unpkg.com/lightweight-charts/dist/lightweight-charts.standalone.production.js"></script>

<style>
body {
  margin:0;
  background:#0e0e0e;
  color:white;
  font-family:Arial;
}

#controls {
  padding:10px;
  background:#111;
  display:flex;
  gap:10px;
}

select {
  padding:5px;
  background:#222;
  color:white;
  border:1px solid #444;
}

#chart {
  height:90vh;
}
</style>
</head>

<body>

<div id="controls">
  Pair:
  <select id="symbol">
    <option value="btcusdt">BTCUSDT</option>
    <option value="ethusdt">ETHUSDT</option>
  </select>

  Timeframe:
  <select id="interval">
    <option value="1s">1s</option>
    <option value="5s">5s</option>
    <option value="1m" selected>1m</option>
    <option value="5m">5m</option>
    <option value="15m">15m</option>
    <option value="1h">1h</option>
  </select>
</div>

<div id="chart"></div>

<script>

const chart = LightweightCharts.createChart(
  document.getElementById('chart'),
  {
    layout: {
      background: { color: '#0e0e0e' },
      textColor: '#ffffff'
    },
    grid: {
      vertLines: { color: '#1f1f1f' },
      horzLines: { color: '#1f1f1f' }
    },
    width: window.innerWidth,
    height: window.innerHeight - 60,
  }
);

const candleSeries = chart.addCandlestickSeries();

let socket;

function connect(symbol, interval) {

  if (socket) socket.close();

  const url = `wss://stream.binance.com:9443/ws/${symbol}@kline_${interval}`;
  socket = new WebSocket(url);

  socket.onmessage = (event) => {
    const data = JSON.parse(event.data);
    const k = data.k;

    candleSeries.update({
      time: k.t / 1000,
      open: parseFloat(k.o),
      high: parseFloat(k.h),
      low: parseFloat(k.l),
      close: parseFloat(k.c)
    });
  };
}

connect("btcusdt", "1m");

document.getElementById("symbol").onchange = function() {
  connect(this.value, document.getElementById("interval").value);
};

document.getElementById("interval").onchange = function() {
  connect(document.getElementById("symbol").value, this.value);
};

</script>

</body>
</html>
